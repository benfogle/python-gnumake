
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Python Functions &#8212; Py-gnumake 0.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Handling Exceptions" href="exceptions.html" />
    <link rel="prev" title="Makefile Functions" href="makefile_funcs.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="exceptions.html" title="Handling Exceptions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="makefile_funcs.html" title="Makefile Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Py-gnumake 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-functions">
<h1>Python Functions<a class="headerlink" href="#python-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="main-api">
<h2>Main API<a class="headerlink" href="#main-api" title="Permalink to this headline">¶</a></h2>
<p>These functions implement the GNU make API used to interact with a makefile.</p>
<dl class="py function">
<dt id="gnumake.export">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">expand</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">min_args</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">max_args</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to expose a function to Python.</p>
<p>All parameters passed to the Python function will be strings. The return
value of the function will be converted to a string according to the
following rules:</p>
<ol class="arabic simple">
<li><p>Strings are unchanged</p></li>
<li><p>True becomes ‘1’</p></li>
<li><p>False and None become an empty string</p></li>
<li><p>Bytes, bytearrays, and anything supporting the buffer protocol will be
converted to a string using the default encoding.</p></li>
<li><p>All other objects use str(obj)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – Function to decorate</p></li>
<li><p><strong>name</strong> (<em>string</em>) – The GNU make name of the function. If omitted,
defaults to the unqualified function name</p></li>
<li><p><strong>expand</strong> (<em>bool</em>) – If True (default) arguments to the function are
expanded by make before the function is called.
Otherwise the function receives the arguments
verbatim, $(variables) and all.</p></li>
<li><p><strong>min_args</strong> (<em>int</em>) – The minimum number of arguments to the function.
If -1, (default) then the number of arguments will
be guessed.</p></li>
<li><p><strong>max_args</strong> (<em>int</em>) – If &gt; 0, the maximum number of arguments to the
function. A value of 0 means any number of
arguments. A value of -1 (default) means that the
number of parameters will be guessed.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@gnumake</span><span class="o">.</span><span class="n">export</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">newer</span><span class="p">(</span><span class="n">file1</span><span class="p">,</span> <span class="n">file2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="sd">&#39;&#39;&#39;Returns the newer file&#39;&#39;&#39;</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file2</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="n">file1</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="n">file2</span>
</pre></div>
</div>
<p>This function can then be used in a makefile as $(newer f1.txt,f2.txt)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@gnumake</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;repeat-loop&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">repeat_loop</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">loop</span><span class="p">):</span>
<span class="gp">... </span>  <span class="sd">&#39;&#39;&#39;A while-loop for the makefile&#39;&#39;&#39;</span>
<span class="gp">... </span>   <span class="k">while</span> <span class="n">gnumake</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">condition</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">gnumake</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
</pre></div>
</div>
<p>This function can be used in a makefile as
$(repeat-loop condition,loop). Both arguments are repeatedly expanded
each time through the loop.</p>
<p>May also be used as a function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">export</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">,</span> <span class="n">min_args</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_args</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="gnumake.expand">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">expand</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand a string according to Makefile rules</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GNU make handles errors by exiting the entire program.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gnumake.evaluate">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a string as Makefile syntax, as if $(eval …) had been used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GNU make handles errors by exiting the entire program.</p>
</div>
</dd></dl>

</div>
<div class="section" id="utilities">
<h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h2>
<p>In addition to the main API, Py-gnumake exposes a few utility functions that
may prove useful.</p>
<dl class="py class">
<dt id="gnumake.Variables">
<em class="property">class </em><code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">Variables</code><a class="headerlink" href="#gnumake.Variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience class for manipulating variables in a more Pythonic manner.</p>
<p>An instance of this class is available as <code class="docutils literal notranslate"><span class="pre">gnumake.variables</span></code> or
<code class="docutils literal notranslate"><span class="pre">gnumake.vars</span></code></p>
<dl class="py method">
<dt id="gnumake.Variables.__contains__">
<code class="sig-name descname">__contains__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for defined(name)</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.__delitem__">
<code class="sig-name descname">__delitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.__delitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for undefine(name)</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for get(name)</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.__setitem__">
<code class="sig-name descname">__setitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.__setitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for set(name, value)</p>
</dd></dl>

<dl class="py attribute">
<dt id="gnumake.Variables.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#gnumake.Variables.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a value to a possibly existing variable. Values will
be appended with a single space between the old value and the new
one. The flavor of the variable will remain unchanged.</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.defined">
<code class="sig-name descname">defined</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.defined" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if a variable has been defined, or False otherwise</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.flavor">
<code class="sig-name descname">flavor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.flavor" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the flavor of a variable. May return ‘simple’, ‘recursive’
or ‘undefined’</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">expand_value</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a variable name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – The name of the variable. This should not
contain a $(…), and computed names are not
allowed.</p></li>
<li><p><strong>default</strong> (<em>string</em>) – Value to return if the result is undefined.
Defaults to an empty string. This value will be
returned only if the variable is undefined, not
if it has been defined to an empty string.</p></li>
<li><p><strong>expand</strong> (<em>bool</em>) – If true (default), the value will be expanded
according to the flavor of the variable. This
is usually what you want. Note that this makes
no difference for simply expanded variables,
which are fully expanded on assignment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the variable</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.origin">
<code class="sig-name descname">origin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the origin of a variable. See make documentation for possible
values and their meanings.</p>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.set">
<code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">flavor</span><span class="o">=</span><span class="default_value">'recursive'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a variable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The variable name</p></li>
<li><p><strong>value</strong> – The variable value. This string will be escaped to preserve
newlines, etc. Dollar signs ($) are _not_ escaped.</p></li>
<li><p><strong>flavor</strong> – May be ‘recursive’ or ‘simple’. Specifying ‘recursive’ is
equivalent to name=value, while ‘simple’ is equivalent to
name:=value. Default is recursive.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="gnumake.Variables.undefine">
<code class="sig-name descname">undefine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.Variables.undefine" title="Permalink to this definition">¶</a></dt>
<dd><p>Undefine a variable</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="gnumake.escape_string">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">escape_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.escape_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape a string such that it can appear in a define directive.
We need to escape ‘endef’ and backslash-newline.</p>
</dd></dl>

<dl class="py function">
<dt id="gnumake.fully_escape_string">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">fully_escape_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.fully_escape_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Escape a string such that it can appear verbatim in a define directive.
This version also escapes $ so that variable expansion does not occur.
We need to escape ‘endef’, backslash-newline, and $.</p>
</dd></dl>

<dl class="py function">
<dt id="gnumake.object_to_string">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">object_to_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.object_to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Python object to a string in a way that will be somewhat sensible
to the makefile:</p>
<ul class="simple">
<li><p>True becomes ‘1’</p></li>
<li><p>False and None become an empty string</p></li>
<li><p>Strings are unchanged.</p></li>
<li><p>Bytes, bytearrays, and anything supporting the buffer protocol are
converted to a string using the default encoding.</p></li>
<li><p>Anything else returns str(obj)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>object</em>) – The object to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a string representation of the object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gnumake.is_legal_name">
<code class="sig-prename descclassname">gnumake.</code><code class="sig-name descname">is_legal_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#gnumake.is_legal_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that a name is a legal makefile variable name</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python Functions</a><ul>
<li><a class="reference internal" href="#main-api">Main API</a></li>
<li><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="makefile_funcs.html"
                        title="previous chapter">Makefile Functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="exceptions.html"
                        title="next chapter">Handling Exceptions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/python_funcs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="exceptions.html" title="Handling Exceptions"
             >next</a> |</li>
        <li class="right" >
          <a href="makefile_funcs.html" title="Makefile Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Py-gnumake 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Benjamin Fogle.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>